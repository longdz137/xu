<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok - Nạp Xu & Quản Trị</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #000;
            color: #fff;
            min-height: 100vh;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #2f2f2f;
        }
        
        .logo {
            display: flex;
            align-items: center;
        }
        
        .logo i {
            color: #ff0050;
            font-size: 28px;
            margin-right: 10px;
        }
        
        .logo span {
            font-size: 20px;
            font-weight: bold;
        }
        
        .user-actions {
            display: flex;
            gap: 15px;
        }
        
        .user-actions i {
            font-size: 20px;
            color: #fff;
            cursor: pointer;
        }
        
        .admin-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .admin-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        /* Admin Header */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #ff0050, #ff7e00);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(255, 0, 80, 0.3);
        }
        
        .admin-title {
            font-size: 28px;
            font-weight: bold;
        }
        
        .admin-actions {
            display: flex;
            gap: 15px;
        }
        
        /* Navigation */
        .nav-tabs {
            display: flex;
            border-bottom: 1px solid #2f2f2f;
            margin-bottom: 20px;
        }
        
        .nav-tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .nav-tab.active {
            border-bottom: 3px solid #ff0050;
            color: #ff0050;
            font-weight: bold;
        }
        
        .nav-tab:hover {
            background-color: #1a1a1a;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            padding: 20px 0;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        
        /* Coin Packages */
        .packages-title {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .coin-packages {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .coin-package {
            background-color: #1a1a1a;
            border: 2px solid #2f2f2f;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .coin-package:hover, .coin-package.selected {
            border-color: #ff0050;
            transform: translateY(-5px);
        }
        
        .coin-package.selected {
            background-color: rgba(255, 0, 80, 0.1);
        }
        
        .coin-amount {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .coin-price {
            color: #ff0050;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .coin-bonus {
            font-size: 12px;
            color: #aaa;
        }
        
        /* Payment Methods */
        .payment-title {
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .payment-methods {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        .payment-method {
            background-color: #1a1a1a;
            border: 1px solid #2f2f2f;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .payment-method:hover, .payment-method.selected {
            border-color: #ff0050;
        }
        
        .payment-icon {
            width: 40px;
            height: 40px;
            background-color: #2f2f2f;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        
        .payment-icon i {
            font-size: 20px;
        }
        
        .payment-info {
            flex: 1;
        }
        
        .payment-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .payment-desc {
            font-size: 12px;
            color: #aaa;
        }
        
        .payment-check {
            color: #ff0050;
            font-size: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .payment-method.selected .payment-check {
            opacity: 1;
        }
        
        /* Recharge Button */
        .recharge-btn {
            background: linear-gradient(135deg, #ff0050, #ff7e00);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }
        
        .recharge-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(255, 0, 80, 0.3);
        }
        
        .recharge-btn:disabled {
            background: #2f2f2f;
            color: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            border-top: 1px solid #2f2f2f;
            font-size: 12px;
            color: #666;
        }
        
        /* Payment Page Styles */
        .payment-page {
            display: none;
        }
        
        .back-button {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            cursor: pointer;
            color: #fff;
            font-size: 16px;
        }
        
        .back-button i {
            margin-right: 10px;
            font-size: 20px;
        }
        
        .order-summary {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .order-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #ff0050;
        }
        
        .order-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .order-code {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #2f2f2f;
        }
        
        .order-code-value {
            color: #ff0050;
            font-weight: bold;
            font-family: monospace;
            letter-spacing: 1px;
        }
        
        .order-total {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #2f2f2f;
            font-weight: bold;
            font-size: 18px;
        }
        
        .payment-form {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .pay-button {
            background: linear-gradient(135deg, #ff0050, #ff7e00);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .pay-button:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(255, 0, 80, 0.3);
        }
        
        .success-message {
            display: none;
            text-align: center;
            padding: 30px;
            background-color: #1a1a1a;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .success-icon {
            font-size: 60px;
            color: #00ff7f;
            margin-bottom: 20px;
        }
        
        .success-title {
            font-size: 24px;
            margin-bottom: 10px;
        }
        
        .success-details {
            margin-bottom: 20px;
            color: #aaa;
        }
        
        .order-id-box {
            background: rgba(255, 0, 80, 0.1);
            border: 1px solid #ff0050;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .order-id-label {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .order-id-value {
            font-size: 18px;
            font-weight: bold;
            color: #ff0050;
            font-family: monospace;
            letter-spacing: 2px;
        }
        
        .continue-button {
            background: linear-gradient(135deg, #ff0050, #ff7e00);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        /* Telegram Notification */
        .telegram-notification {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #0088cc;
        }
        
        .telegram-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .telegram-icon {
            color: #0088cc;
            font-size: 24px;
            margin-right: 10px;
        }
        
        .telegram-title {
            font-size: 18px;
            font-weight: bold;
        }
        
        .telegram-message {
            line-height: 1.5;
            color: #ddd;
        }
        
        .telegram-highlight {
            color: #ff0050;
            font-weight: bold;
        }
        
        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #ff0050;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Order History */
        .order-history {
            display: none;
        }
        
        .history-title {
            font-size: 20px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .history-empty {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        
        .history-empty i {
            font-size: 50px;
            margin-bottom: 15px;
            color: #2f2f2f;
        }
        
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .history-item {
            background-color: #1a1a1a;
            border-radius: 12px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .history-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 80, 0.1);
        }
        
        .history-info {
            flex: 1;
        }
        
        .history-order-code {
            font-weight: bold;
            margin-bottom: 5px;
            color: #ff0050;
            font-family: monospace;
        }
        
        .history-details {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .history-date {
            font-size: 12px;
            color: #666;
        }
        
        .history-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .status-completed {
            background-color: rgba(0, 255, 127, 0.1);
            color: #00ff7f;
        }
        
        .status-pending {
            background-color: rgba(255, 165, 0, 0.1);
            color: #ffa500;
        }
        
        .status-failed {
            background-color: rgba(255, 0, 80, 0.1);
            color: #ff0050;
        }
        
        /* Order Search */
        .order-search {
            display: none;
        }
        
        .search-form {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .search-input-group {
            display: flex;
            gap: 10px;
        }
        
        .search-input {
            flex: 1;
            padding: 12px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
        }
        
        .search-button {
            background: linear-gradient(135deg, #ff0050, #ff7e00);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .search-button:hover {
            transform: scale(1.05);
        }
        
        .search-results {
            display: none;
        }
        
        .order-detail {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .order-detail-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: #ff0050;
            text-align: center;
        }
        
        .order-detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #2f2f2f;
        }
        
        .order-detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .order-detail-label {
            color: #aaa;
        }
        
        .order-detail-value {
            font-weight: bold;
        }
        
        .not-found {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        
        .not-found i {
            font-size: 50px;
            margin-bottom: 15px;
            color: #2f2f2f;
        }
        
        /* Admin Page Styles */
        .admin-page {
            display: none;
        }
        
        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid #2f2f2f;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 0, 80, 0.2);
        }
        
        .stat-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .stat-pending .stat-icon {
            color: #ffa500;
        }
        
        .stat-completed .stat-icon {
            color: #00ff7f;
        }
        
        .stat-failed .stat-icon {
            color: #ff0050;
        }
        
        .stat-total .stat-icon {
            color: #0088cc;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #aaa;
            font-size: 14px;
        }
        
        /* Filters */
        .filters {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #2f2f2f;
        }
        
        .filter-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #aaa;
        }
        
        .filter-select, .filter-input {
            width: 100%;
            padding: 12px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
        }
        
        /* Orders Table */
        .orders-container {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 20px;
            border: 1px solid #2f2f2f;
        }
        
        .orders-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .orders-title {
            font-size: 20px;
            font-weight: bold;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
        }
        
        .admin-search-input {
            padding: 10px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            width: 300px;
        }
        
        .orders-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .orders-table th {
            background-color: #2f2f2f;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #ff0050;
            border-bottom: 2px solid #ff0050;
        }
        
        .orders-table td {
            padding: 15px;
            border-bottom: 1px solid #2f2f2f;
        }
        
        .orders-table tr:hover {
            background-color: #252525;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-approve {
            background-color: rgba(0, 255, 127, 0.2);
            color: #00ff7f;
            border: 1px solid #00ff7f;
        }
        
        .btn-approve:hover {
            background-color: rgba(0, 255, 127, 0.3);
        }
        
        .btn-reject {
            background-color: rgba(255, 0, 80, 0.2);
            color: #ff0050;
            border: 1px solid #ff0050;
        }
        
        .btn-reject:hover {
            background-color: rgba(255, 0, 80, 0.3);
        }
        
        .btn-detail {
            background-color: rgba(0, 136, 204, 0.2);
            color: #0088cc;
            border: 1px solid #0088cc;
        }
        
        .btn-detail:hover {
            background-color: rgba(0, 136, 204, 0.3);
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .page-btn {
            padding: 8px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .page-btn:hover {
            background-color: #3f3f3f;
        }
        
        .page-btn.active {
            background-color: #ff0050;
            border-color: #ff0050;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            border: 1px solid #2f2f2f;
            position: relative;
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #ff0050;
            text-align: center;
        }
        
        .order-detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #2f2f2f;
        }
        
        .detail-label {
            color: #aaa;
        }
        
        .detail-value {
            font-weight: bold;
        }
        
        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .modal-btn-approve {
            background: linear-gradient(135deg, #00ff7f, #00cc66);
            color: #000;
        }
        
        .modal-btn-reject {
            background: linear-gradient(135deg, #ff0050, #cc0040);
            color: #fff;
        }
        
        /* Bot Configuration */
        .bot-config {
            background-color: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #2f2f2f;
        }
        
        .config-title {
            font-size: 20px;
            margin-bottom: 20px;
            color: #ff0050;
            text-align: center;
        }
        
        .config-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .config-group {
            margin-bottom: 15px;
        }
        
        .config-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #aaa;
        }
        
        .config-input {
            width: 100%;
            padding: 12px 15px;
            background-color: #2f2f2f;
            border: 1px solid #444;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
        }
        
        .config-help {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        .config-actions {
            grid-column: 1 / -1;
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .config-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .config-btn-save {
            background: linear-gradient(135deg, #00ff7f, #00cc66);
            color: #000;
        }
        
        .config-btn-test {
            background: linear-gradient(135deg, #0088cc, #006699);
            color: #fff;
        }
        
        .config-status {
            grid-column: 1 / -1;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .status-success {
            background-color: rgba(0, 255, 127, 0.1);
            color: #00ff7f;
            border: 1px solid #00ff7f;
        }
        
        .status-error {
            background-color: rgba(255, 0, 80, 0.1);
            color: #ff0050;
            border: 1px solid #ff0050;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-container {
                padding: 10px;
            }
            
            .admin-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .filter-row {
                flex-direction: column;
            }
            
            .admin-search-input {
                width: 100%;
            }
            
            .orders-table {
                display: block;
                overflow-x: auto;
            }
            
            .order-detail-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .coin-packages {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .history-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .history-status {
                align-self: flex-end;
            }
            
            .search-input-group {
                flex-direction: column;
            }
            
            .config-form {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Trang chính nạp xu -->
    <div id="rechargePage" class="recharge-page">
        <header>
            <div class="logo">
                <i class="fab fa-tiktok"></i>
                <span>TikTok</span>
            </div>
            <div class="user-actions">
                <i class="fas fa-search" id="searchButton"></i>
                <i class="fas fa-history" id="historyButton"></i>
                <button class="admin-btn" id="adminButton">
                    <i class="fas fa-cog"></i> Quản trị
                </button>
            </div>
        </header>
        
        <div class="container">
            <div class="nav-tabs">
                <div class="nav-tab active" data-tab="recharge">Nạp Xu</div>
                <div class="nav-tab" data-tab="history">Lịch Sử Đơn Hàng</div>
                <div class="nav-tab" data-tab="search">Tra Cứu Đơn Hàng</div>
            </div>
            
            <div class="main-content">
                <!-- Tab Nạp Xu -->
                <div id="rechargeTab" class="tab-content">
                    <h1 class="page-title">Nạp Xu</h1>
                    
                    <h2 class="packages-title">Chọn gói xu</h2>
                    <div class="coin-packages">
                        <div class="coin-package" data-coins="100" data-price="23000">
                            <div class="coin-amount">100 Xu</div>
                            <div class="coin-price">23.000đ</div>
                            <div class="coin-bonus">Không tặng kèm</div>
                        </div>
                        <div class="coin-package" data-coins="500" data-price="115000">
                            <div class="coin-amount">500 Xu</div>
                            <div class="coin-price">115.000đ</div>
                            <div class="coin-bonus">+20 Xu tặng kèm</div>
                        </div>
                        <div class="coin-package" data-coins="1000" data-price="229000">
                            <div class="coin-amount">1.000 Xu</div>
                            <div class="coin-price">229.000đ</div>
                            <div class="coin-bonus">+100 Xu tặng kèm</div>
                        </div>
                        <div class="coin-package" data-coins="2500" data-price="569000">
                            <div class="coin-amount">2.500 Xu</div>
                            <div class="coin-price">569.000đ</div>
                            <div class="coin-bonus">+400 Xu tặng kèm</div>
                        </div>
                        <div class="coin-package" data-coins="5000" data-price="1149000">
                            <div class="coin-amount">5.000 Xu</div>
                            <div class="coin-price">1.149.000đ</div>
                            <div class="coin-bonus">+1.000 Xu tặng kèm</div>
                        </div>
                        <div class="coin-package" data-coins="10000" data-price="2299000">
                            <div class="coin-amount">10.000 Xu</div>
                            <div class="coin-price">2.299.000đ</div>
                            <div class="coin-bonus">+2.500 Xu tặng kèm</div>
                        </div>
                    </div>
                    
                    <h2 class="payment-title">Chọn phương thức thanh toán</h2>
                    <div class="payment-methods">
                        <div class="payment-method" data-method="credit">
                            <div class="payment-icon">
                                <i class="far fa-credit-card"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">Thẻ tín dụng/ghi nợ</div>
                                <div class="payment-desc">Visa, MasterCard, American Express</div>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="payment-method" data-method="momo">
                            <div class="payment-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">Ví MoMo</div>
                                <div class="payment-desc">Thanh toán qua ứng dụng MoMo</div>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="payment-method" data-method="zalopay">
                            <div class="payment-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">ZaloPay</div>
                                <div class="payment-desc">Thanh toán qua ZaloPay</div>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="payment-method" data-method="banking">
                            <div class="payment-icon">
                                <i class="fas fa-university"></i>
                            </div>
                            <div class="payment-info">
                                <div class="payment-name">Chuyển khoản ngân hàng</div>
                                <div class="payment-desc">Chuyển khoản trực tiếp</div>
                            </div>
                            <div class="payment-check">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>
                    
                    <button class="recharge-btn" id="rechargeBtn" disabled>Chọn gói để nạp xu</button>
                </div>
                
                <!-- Tab Lịch Sử Đơn Hàng -->
                <div id="historyTab" class="order-history">
                    <h2 class="history-title">Lịch Sử Đơn Hàng</h2>
                    <div class="history-list" id="historyList">
                        <!-- Lịch sử đơn hàng sẽ được thêm vào đây bằng JavaScript -->
                    </div>
                    <div class="history-empty" id="historyEmpty">
                        <i class="fas fa-receipt"></i>
                        <p>Chưa có đơn hàng nào</p>
                    </div>
                </div>
                
                <!-- Tab Tra Cứu Đơn Hàng -->
                <div id="searchTab" class="order-search">
                    <h2 class="history-title">Tra Cứu Đơn Hàng</h2>
                    
                    <div class="search-form">
                        <div class="search-input-group">
                            <input type="text" class="search-input" id="searchOrderInput" placeholder="Nhập mã đơn hàng (VD: TT-123456)">
                            <button class="search-button" id="searchOrderButton">
                                <i class="fas fa-search"></i> Tìm kiếm
                            </button>
                        </div>
                    </div>
                    
                    <div class="search-results" id="searchResults">
                        <!-- Kết quả tìm kiếm sẽ được hiển thị ở đây -->
                    </div>
                    
                    <div class="not-found" id="searchNotFound" style="display: none;">
                        <i class="fas fa-search"></i>
                        <p>Không tìm thấy đơn hàng</p>
                        <p style="font-size: 14px; margin-top: 10px;">Vui lòng kiểm tra lại mã đơn hàng</p>
                    </div>
                </div>
                
                <footer>
                    <p>Bằng cách tiếp tục, bạn đồng ý với Điều khoản Dịch vụ và Chính sách Quyền riêng tư của chúng tôi</p>
                </footer>
            </div>
        </div>
    </div>
    
    <!-- Trang thanh toán -->
    <div id="paymentPage" class="payment-page">
        <header>
            <div class="logo">
                <i class="fab fa-tiktok"></i>
                <span>TikTok</span>
            </div>
            <div class="user-actions">
                <i class="fas fa-search" id="searchButtonPayment"></i>
                <i class="fas fa-history" id="historyButtonPayment"></i>
                <button class="admin-btn" id="adminButtonPayment">
                    <i class="fas fa-cog"></i> Quản trị
                </button>
            </div>
        </header>
        
        <div class="container">
            <div class="main-content">
                <div class="back-button" id="backButton">
                    <i class="fas fa-arrow-left"></i>
                    <span>Quay lại</span>
                </div>
                
                <h1 class="page-title">Thanh Toán</h1>
                
                <div class="order-summary">
                    <h2 class="order-title">Thông tin đơn hàng</h2>
                    <div class="order-details">
                        <span>Gói xu:</span>
                        <span id="orderCoins">0 Xu</span>
                    </div>
                    <div class="order-details">
                        <span>Xu tặng kèm:</span>
                        <span id="orderBonus">0 Xu</span>
                    </div>
                    <div class="order-details">
                        <span>Phương thức thanh toán:</span>
                        <span id="orderMethod">Chưa chọn</span>
                    </div>
                    <div class="order-code">
                        <span>Mã đơn hàng:</span>
                        <span class="order-code-value" id="orderCode">TT-000000</span>
                    </div>
                    <div class="order-total">
                        <span>Tổng cộng:</span>
                        <span id="orderTotal">0đ</span>
                    </div>
                </div>
                
                <!-- Thông báo Telegram -->
                <div class="telegram-notification" id="telegramNotification">
                    <div class="telegram-header">
                        <i class="fab fa-telegram telegram-icon"></i>
                        <div class="telegram-title">Thông báo Telegram</div>
                    </div>
                    <div class="telegram-message">
                        Thông báo đã được gửi đến <span class="telegram-highlight">@TikTokCoinBot</span> trên Telegram. 
                        Quản trị viên sẽ xử lý đơn hàng của bạn trong thời gian sớm nhất. 
                        Bạn sẽ nhận được thông báo khi giao dịch hoàn tất.
                    </div>
                </div>
                
                <div class="payment-form" id="creditCardForm">
                    <h2 class="order-title">Thông tin thẻ</h2>
                    <div class="form-group">
                        <label for="cardNumber">Số thẻ</label>
                        <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456">
                    </div>
                    <div class="form-group">
                        <label for="cardName">Tên chủ thẻ</label>
                        <input type="text" id="cardName" placeholder="NGUYEN VAN A">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="cardExpiry">Ngày hết hạn</label>
                            <input type="text" id="cardExpiry" placeholder="MM/YY">
                        </div>
                        <div class="form-group">
                            <label for="cardCVC">Mã CVC</label>
                            <input type="text" id="cardCVC" placeholder="123">
                        </div>
                    </div>
                </div>
                
                <div class="payment-form" id="momoForm" style="display: none;">
                    <h2 class="order-title">Thanh toán bằng MoMo</h2>
                    <div class="form-group">
                        <label for="momoPhone">Số điện thoại MoMo</label>
                        <input type="text" id="momoPhone" placeholder="0912 345 678">
                    </div>
                    <p style="font-size: 14px; color: #aaa; margin-top: 20px;">
                        Bạn sẽ được chuyển hướng đến ứng dụng MoMo để hoàn tất thanh toán.
                    </p>
                </div>
                
                <div class="payment-form" id="zalopayForm" style="display: none;">
                    <h2 class="order-title">Thanh toán bằng ZaloPay</h2>
                    <div class="form-group">
                        <label for="zaloPhone">Số điện thoại ZaloPay</label>
                        <input type="text" id="zaloPhone" placeholder="0912 345 678">
                    </div>
                    <p style="font-size: 14px; color: #aaa; margin-top: 20px;">
                        Bạn sẽ được chuyển hướng đến ứng dụng ZaloPay để hoàn tất thanh toán.
                    </p>
                </div>
                
                <div class="payment-form" id="bankingForm" style="display: none;">
                    <h2 class="order-title">Chuyển khoản ngân hàng</h2>
                    <div class="form-group">
                        <label>Thông tin chuyển khoản</label>
                        <div style="background-color: #2f2f2f; padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <p style="margin-bottom: 10px;">Ngân hàng: <strong>Techcombank</strong></p>
                            <p style="margin-bottom: 10px;">Số tài khoản: <strong>1903 2053 8012</strong></p>
                            <p style="margin-bottom: 10px;">Chủ tài khoản: <strong>CÔNG TY TNHH TIKTOK VIETNAM</strong></p>
                            <p style="margin-bottom: 10px;">Số tiền: <strong id="bankAmount">0đ</strong></p>
                            <p style="margin-bottom: 10px;">Nội dung: <strong id="bankContent">NAPXU TIKTOK [MÃ ĐƠN HÀNG]</strong></p>
                        </div>
                    </div>
                    <p style="font-size: 14px; color: #aaa; margin-top: 20px;">
                        Vui lòng chuyển khoản đúng số tiền và nội dung như trên. Xu sẽ được cộng vào tài khoản của bạn trong vòng 5-10 phút sau khi chuyển khoản thành công.
                    </p>
                </div>
                
                <div class="loading" id="loading">
                    <div class="loading-spinner"></div>
                    <p>Đang gửi thông báo đến Telegram...</p>
                </div>
                
                <button class="pay-button" id="payButton">Xác nhận thanh toán</button>
                
                <div class="success-message" id="successMessage">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2 class="success-title">Thanh toán thành công!</h2>
                    <p class="success-details">Bạn đã nạp thành công <span id="successCoins">0</span> xu vào tài khoản TikTok.</p>
                    
                    <div class="order-id-box">
                        <div class="order-id-label">Mã đơn hàng của bạn</div>
                        <div class="order-id-value" id="successOrderCode">TT-000000</div>
                    </div>
                    
                    <p class="success-details">Thông báo đã được gửi đến quản trị viên qua Telegram.</p>
                    <p class="success-details">Vui lòng lưu lại mã đơn hàng để tra cứu khi cần.</p>
                    <button class="continue-button" id="continueButton">Tiếp tục</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Trang Quản Trị -->
    <div id="adminPage" class="admin-page">
        <div class="admin-container">
            <!-- Header -->
            <div class="admin-header">
                <div class="logo">
                    <i class="fab fa-tiktok"></i>
                    <span>TikTok Admin</span>
                </div>
                <div class="admin-title">DUYỆT ĐƠN HÀNG NẠP XU</div>
                <div class="admin-actions">
                    <button class="admin-btn" id="refreshAdmin">
                        <i class="fas fa-sync-alt"></i> Làm mới
                    </button>
                    <button class="admin-btn" id="backToUser">
                        <i class="fas fa-arrow-left"></i> Về trang người dùng
                    </button>
                    <button class="admin-btn" id="configButton">
                        <i class="fas fa-robot"></i> Cấu hình Bot
                    </button>
                </div>
            </div>
            
            <!-- Bot Configuration Section -->
            <div class="bot-config" id="botConfigSection">
                <h2 class="config-title">CẤU HÌNH TELEGRAM BOT</h2>
                
                <div class="config-form">
                    <div class="config-group">
                        <label class="config-label">Bot Token</label>
                        <input type="password" class="config-input" id="botToken" placeholder="Nhập token của bot Telegram">
                        <div class="config-help">Lấy token từ @BotFather trên Telegram</div>
                    </div>
                    
                    <div class="config-group">
                        <label class="config-label">Chat ID</label>
                        <input type="text" class="config-input" id="chatId" placeholder="Nhập Chat ID để nhận thông báo">
                        <div class="config-help">Chat ID của người/quản trị viên nhận thông báo</div>
                    </div>
                    
                    <div class="config-group">
                        <label class="config-label">Tên Bot</label>
                        <input type="text" class="config-input" id="botName" placeholder="Tên hiển thị của bot">
                        <div class="config-help">Tên bot sẽ hiển thị trong thông báo</div>
                    </div>
                    
                    <div class="config-group">
                        <label class="config-label">URL Webhook (Tùy chọn)</label>
                        <input type="text" class="config-input" id="webhookUrl" placeholder="https://your-domain.com/webhook">
                        <div class="config-help">URL nhận webhook từ Telegram (nếu có)</div>
                    </div>
                    
                    <div class="config-actions">
                        <button class="config-btn config-btn-save" id="saveBotConfig">
                            <i class="fas fa-save"></i> Lưu Cấu Hình
                        </button>
                        <button class="config-btn config-btn-test" id="testBotConfig">
                            <i class="fas fa-paper-plane"></i> Gửi Thử
                        </button>
                    </div>
                    
                    <div class="config-status" id="configStatus" style="display: none;"></div>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="stats-container">
                <div class="stat-card stat-pending">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-number" id="pendingCount">0</div>
                    <div class="stat-label">ĐƠN CHỜ DUYỆT</div>
                </div>
                <div class="stat-card stat-completed">
                    <div class="stat-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-number" id="completedCount">0</div>
                    <div class="stat-label">ĐƠN THÀNH CÔNG</div>
                </div>
                <div class="stat-card stat-failed">
                    <div class="stat-icon">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="stat-number" id="failedCount">0</div>
                    <div class="stat-label">ĐƠN THẤT BẠI</div>
                </div>
                <div class="stat-card stat-total">
                    <div class="stat-icon">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">TỔNG ĐƠN HÀNG</div>
                </div>
            </div>
            
            <!-- Filters -->
            <div class="filters">
                <div class="filter-row">
                    <div class="filter-group">
                        <label class="filter-label">Trạng thái</label>
                        <select class="filter-select" id="statusFilter">
                            <option value="all">Tất cả trạng thái</option>
                            <option value="pending">Chờ duyệt</option>
                            <option value="completed">Thành công</option>
                            <option value="failed">Thất bại</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Phương thức thanh toán</label>
                        <select class="filter-select" id="paymentFilter">
                            <option value="all">Tất cả phương thức</option>
                            <option value="credit">Thẻ tín dụng</option>
                            <option value="momo">Ví MoMo</option>
                            <option value="zalopay">ZaloPay</option>
                            <option value="banking">Chuyển khoản</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Từ ngày</label>
                        <input type="date" class="filter-input" id="dateFrom">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Đến ngày</label>
                        <input type="date" class="filter-input" id="dateTo">
                    </div>
                </div>
            </div>
            
            <!-- Orders Table -->
            <div class="orders-container">
                <div class="orders-header">
                    <div class="orders-title">DANH SÁCH ĐƠN HÀNG</div>
                    <div class="search-box">
                        <input type="text" class="admin-search-input" id="searchOrderAdmin" placeholder="Tìm kiếm theo mã đơn hàng...">
                        <button class="admin-btn" id="searchAdminButton">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <table class="orders-table">
                    <thead>
                        <tr>
                            <th>MÃ ĐƠN HÀNG</th>
                            <th>THÔNG TIN</th>
                            <th>PHƯƠNG THỨC</th>
                            <th>THỜI GIAN</th>
                            <th>TRẠNG THÁI</th>
                            <th>THAO TÁC</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Orders will be populated by JavaScript -->
                    </tbody>
                </table>
                
                <!-- Pagination -->
                <div class="pagination">
                    <button class="page-btn"><i class="fas fa-chevron-left"></i></button>
                    <button class="page-btn active">1</button>
                    <button class="page-btn">2</button>
                    <button class="page-btn">3</button>
                    <button class="page-btn"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Detail Modal -->
    <div class="modal" id="orderModal">
        <div class="modal-content">
            <button class="modal-close" id="closeModal">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="modal-title">CHI TIẾT ĐƠN HÀNG</h2>
            
            <div class="order-detail-grid">
                <div class="detail-item">
                    <span class="detail-label">Mã đơn hàng:</span>
                    <span class="detail-value order-code" id="modalOrderCode">TT-123456</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Gói xu:</span>
                    <span class="detail-value" id="modalCoins">1,000 Xu</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Số tiền:</span>
                    <span class="detail-value" id="modalPrice">229,000đ</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Phương thức:</span>
                    <span class="detail-value" id="modalMethod">Ví MoMo</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Trạng thái:</span>
                    <span class="detail-value">
                        <span class="order-status status-pending" id="modalStatus">Chờ duyệt</span>
                    </span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Thời gian:</span>
                    <span class="detail-value" id="modalDate">01/12/2023 14:30</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Người dùng:</span>
                    <span class="detail-value" id="modalUser">user_12345</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Số điện thoại:</span>
                    <span class="detail-value" id="modalPhone">0912***678</span>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn modal-btn-approve" id="approveOrder">
                    <i class="fas fa-check"></i> DUYỆT ĐƠN
                </button>
                <button class="modal-btn modal-btn-reject" id="rejectOrder">
                    <i class="fas fa-times"></i> TỪ CHỐI
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== CẤU HÌNH BOT TELEGRAM ====================
        
        // Lưu trữ cấu hình bot
        const getBotConfig = () => {
            return JSON.parse(localStorage.getItem('tiktokBotConfig')) || {
                botToken: '',
                chatId: '',
                botName: 'TikTok Coin Bot',
                webhookUrl: '',
                enabled: false
            };
        };

        const saveBotConfig = (config) => {
            localStorage.setItem('tiktokBotConfig', JSON.stringify(config));
        };

        // Hàm gửi tin nhắn Telegram
        const sendTelegramMessage = async (message, order = null) => {
            const config = getBotConfig();
            
            if (!config.botToken || !config.chatId) {
                console.warn('❌ Chưa cấu hình Bot Token hoặc Chat ID');
                return { success: false, error: 'Chưa cấu hình bot' };
            }

            try {
                // Format message với thông tin đơn hàng
                let formattedMessage = message;
                if (order) {
                    formattedMessage = `🔔 ${config.botName.toUpperCase()}
                    
📦 Mã đơn hàng: ${order.code}
💰 Gói xu: ${order.coins}
💵 Số tiền: ${order.price}
🕒 Thời gian: ${formatDate(order.date)}
👤 Người dùng: ${order.user}


${message}`;
                }

                const url = `https://api.telegram.org/bot${config.botToken}/sendMessage`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: config.chatId,
                        text: formattedMessage,
                        parse_mode: 'HTML'
                    })
                });

                const data = await response.json();
                
                if (data.ok) {
                    console.log('✅ Tin nhắn Telegram đã được gửi');
                    return { success: true, data: data };
                } else {
                    console.error('❌ Lỗi gửi Telegram:', data);
                    return { success: false, error: data.description };
                }
            } catch (error) {
                console.error('❌ Lỗi kết nối Telegram:', error);
                return { success: false, error: error.message };
            }
        };

        // Kiểm tra cấu hình bot
        const testBotConnection = async () => {
            const config = getBotConfig();
            
            if (!config.botToken) {
                return { success: false, error: 'Vui lòng nhập Bot Token' };
            }
            
            if (!config.chatId) {
                return { success: false, error: 'Vui lòng nhập Chat ID' };
            }

            try {
                // Kiểm tra bot info
                const botInfoUrl = `https://api.telegram.org/bot${config.botToken}/getMe`;
                const botInfoResponse = await fetch(botInfoUrl);
                const botInfo = await botInfoResponse.json();

                if (!botInfo.ok) {
                    return { success: false, error: 'Bot Token không hợp lệ' };
                }

                // Gửi tin nhắn thử nghiệm
                const testMessage = `🤖 ${config.botName} - Kết nối thành công!
                
✅ Bot đã được kết nối thành công với hệ thống TikTok Coin.
⏰ Thời gian: ${new Date().toLocaleString('vi-VN')}
📊 Sẵn sàng nhận thông báo đơn hàng!`;

                const result = await sendTelegramMessage(testMessage);
                
                if (result.success) {
                    return { 
                        success: true, 
                        message: `Kết nối thành công! Bot: @${botInfo.result.username}` 
                    };
                } else {
                    return { success: false, error: result.error };
                }
            } catch (error) {
                return { success: false, error: 'Lỗi kết nối: ' + error.message };
            }
        };

        // ==================== HỆ THỐNG LƯU TRỮ ĐỒNG BỘ ====================
        
        // Khởi tạo dữ liệu mẫu
        const initializeSampleData = () => {
            if (!localStorage.getItem('tiktokOrders')) {
                const sampleOrders = [
                    {
                        id: 1,
                        code: "TT-784512",
                        coins: "500 Xu",
                        price: "115,000đ",
                        method: "Ví MoMo",
                        date: new Date().toISOString(),
                        status: "pending",
                        user: "user_12345",
                        phone: "0912***678",
                        bonus: "+20 Xu",
                        amount: 115000
                    },
                    {
                        id: 2,
                        code: "TT-784513",
                        coins: "1,000 Xu",
                        price: "229,000đ",
                        method: "ZaloPay",
                        date: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(),
                        status: "completed",
                        user: "user_67890",
                        phone: "0934***123",
                        bonus: "+100 Xu",
                        amount: 229000
                    },
                    {
                        id: 3,
                        code: "TT-784514",
                        coins: "2,500 Xu",
                        price: "569,000đ",
                        method: "Chuyển khoản",
                        date: new Date(Date.now() - 4 * 60 * 60 * 1000).toISOString(),
                        status: "pending",
                        user: "user_45678",
                        phone: "0978***456",
                        bonus: "+400 Xu",
                        amount: 569000
                    }
                ];
                localStorage.setItem('tiktokOrders', JSON.stringify(sampleOrders));
            }
        };

        // Lấy danh sách đơn hàng
        const getOrders = () => {
            return JSON.parse(localStorage.getItem('tiktokOrders')) || [];
        };

        // Lưu danh sách đơn hàng
        const saveOrders = (orders) => {
            localStorage.setItem('tiktokOrders', JSON.stringify(orders));
        };

        // Thêm đơn hàng mới
        const addOrder = (order) => {
            const orders = getOrders();
            orders.unshift(order);
            saveOrders(orders);
            return order;
        };

        // Cập nhật đơn hàng
        const updateOrder = (orderId, updates) => {
            const orders = getOrders();
            const orderIndex = orders.findIndex(order => order.id === orderId);
            if (orderIndex !== -1) {
                orders[orderIndex] = { ...orders[orderIndex], ...updates };
                saveOrders(orders);
                return orders[orderIndex];
            }
            return null;
        };

        // Tìm đơn hàng theo mã
        const findOrderByCode = (code) => {
            const orders = getOrders();
            return orders.find(order => order.code === code);
        };

        // ==================== TRANG NGƯỜI DÙNG ====================

        // Elements
        const rechargePage = document.getElementById('rechargePage');
        const paymentPage = document.getElementById('paymentPage');
        const adminPage = document.getElementById('adminPage');
        const rechargeBtn = document.getElementById('rechargeBtn');
        const backButton = document.getElementById('backButton');
        const payButton = document.getElementById('payButton');
        const continueButton = document.getElementById('continueButton');
        const successMessage = document.getElementById('successMessage');
        const telegramNotification = document.getElementById('telegramNotification');
        const loading = document.getElementById('loading');
        const historyButton = document.getElementById('historyButton');
        const searchButton = document.getElementById('searchButton');
        const adminButton = document.getElementById('adminButton');
        const adminButtonPayment = document.getElementById('adminButtonPayment');
        
        // Tabs
        const navTabs = document.querySelectorAll('.nav-tab');
        const rechargeTab = document.getElementById('rechargeTab');
        const historyTab = document.getElementById('historyTab');
        const searchTab = document.getElementById('searchTab');
        
        // History
        const historyList = document.getElementById('historyList');
        const historyEmpty = document.getElementById('historyEmpty');
        
        // Search
        const searchOrderInput = document.getElementById('searchOrderInput');
        const searchOrderButton = document.getElementById('searchOrderButton');
        const searchResults = document.getElementById('searchResults');
        const searchNotFound = document.getElementById('searchNotFound');
        
        // Package and payment selection
        const coinPackages = document.querySelectorAll('.coin-package');
        const paymentMethods = document.querySelectorAll('.payment-method');
        
        // Order details elements
        const orderCoins = document.getElementById('orderCoins');
        const orderBonus = document.getElementById('orderBonus');
        const orderMethod = document.getElementById('orderMethod');
        const orderTotal = document.getElementById('orderTotal');
        const orderCode = document.getElementById('orderCode');
        const bankAmount = document.getElementById('bankAmount');
        const bankContent = document.getElementById('bankContent');
        const successCoins = document.getElementById('successCoins');
        const successOrderCode = document.getElementById('successOrderCode');
        
        // Payment forms
        const creditCardForm = document.getElementById('creditCardForm');
        const momoForm = document.getElementById('momoForm');
        const zalopayForm = document.getElementById('zalopayForm');
        const bankingForm = document.getElementById('bankingForm');
        
        // Selected items
        let selectedPackage = null;
        let selectedPayment = null;
        let currentOrderCode = '';

        // ==================== TRANG QUẢN TRỊ ====================

        // Admin Elements
        const refreshAdmin = document.getElementById('refreshAdmin');
        const backToUser = document.getElementById('backToUser');
        const configButton = document.getElementById('configButton');
        const searchOrderAdmin = document.getElementById('searchOrderAdmin');
        const searchAdminButton = document.getElementById('searchAdminButton');
        const ordersTableBody = document.getElementById('ordersTableBody');
        const orderModal = document.getElementById('orderModal');
        const closeModal = document.getElementById('closeModal');
        const approveOrderBtn = document.getElementById('approveOrder');
        const rejectOrderBtn = document.getElementById('rejectOrder');
        const statusFilter = document.getElementById('statusFilter');
        const paymentFilter = document.getElementById('paymentFilter');

        // Bot Config Elements
        const botConfigSection = document.getElementById('botConfigSection');
        const botToken = document.getElementById('botToken');
        const chatId = document.getElementById('chatId');
        const botName = document.getElementById('botName');
        const webhookUrl = document.getElementById('webhookUrl');
        const saveBotConfigBtn = document.getElementById('saveBotConfig');
        const testBotConfigBtn = document.getElementById('testBotConfig');
        const configStatus = document.getElementById('configStatus');

        // Stats elements
        const pendingCount = document.getElementById('pendingCount');
        const completedCount = document.getElementById('completedCount');
        const failedCount = document.getElementById('failedCount');
        const totalCount = document.getElementById('totalCount');

        // Modal elements
        const modalOrderCode = document.getElementById('modalOrderCode');
        const modalCoins = document.getElementById('modalCoins');
        const modalPrice = document.getElementById('modalPrice');
        const modalMethod = document.getElementById('modalMethod');
        const modalStatus = document.getElementById('modalStatus');
        const modalDate = document.getElementById('modalDate');
        const modalUser = document.getElementById('modalUser');
        const modalPhone = document.getElementById('modalPhone');

        let currentOrders = [];
        let selectedOrder = null;

        // ==================== HÀM TIỆN ÍCH ====================

        // Generate order code
        const generateOrderCode = () => {
            const prefix = 'TT';
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `${prefix}-${timestamp}${random}`;
        };

        // Format price with thousand separators
        const formatPrice = (price) => {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        };

        // Format date
        const formatDate = (date) => {
            return new Date(date).toLocaleString('vi-VN');
        };

        // Get payment method name
        const getPaymentMethodName = (method) => {
            const methods = {
                'credit': 'Thẻ tín dụng/ghi nợ',
                'momo': 'Ví MoMo',
                'zalopay': 'ZaloPay',
                'banking': 'Chuyển khoản ngân hàng'
            };
            return methods[method] || 'Không xác định';
        };

        // Get payment method from name
        const getPaymentMethodFromName = (name) => {
            const methods = {
                'Thẻ tín dụng/ghi nợ': 'credit',
                'Ví MoMo': 'momo',
                'ZaloPay': 'zalopay',
                'Chuyển khoản ngân hàng': 'banking'
            };
            return methods[name] || 'credit';
        };

        // ==================== TRANG NGƯỜI DÙNG - CHỨC NĂNG ====================

        // Update recharge button text and state
        const updateRechargeButton = () => {
            if (selectedPackage && selectedPayment) {
                const coins = selectedPackage.getAttribute('data-coins');
                const price = selectedPackage.getAttribute('data-price');
                rechargeBtn.textContent = `Nạp ${coins} Xu với ${formatPrice(price)}đ`;
                rechargeBtn.disabled = false;
            } else if (selectedPackage) {
                rechargeBtn.textContent = 'Chọn phương thức thanh toán';
                rechargeBtn.disabled = true;
            } else {
                rechargeBtn.textContent = 'Chọn gói để nạp xu';
                rechargeBtn.disabled = true;
            }
        };

        // Save order to history
        const saveOrderToHistory = (order) => {
            const newOrder = {
                id: Date.now(),
                code: order.code,
                coins: order.coins,
                price: order.price,
                method: getPaymentMethodFromName(order.method),
                status: 'pending',
                date: new Date().toISOString(),
                user: `user_${Math.floor(10000 + Math.random() * 90000)}`,
                phone: `09${Math.floor(10000000 + Math.random() * 90000000)}`.replace(/(\d{3})(\d{3})(\d{3})/, '$1***$3'),
                bonus: order.bonus,
                amount: parseInt(order.price.replace(/\D/g, ''))
            };
            
            addOrder(newOrder);
            updateUserHistoryDisplay();
            
            // Gửi thông báo Telegram
            sendTelegramNotification(newOrder, 'created');
        };

        // Update user history display
        const updateUserHistoryDisplay = () => {
            const orders = getOrders();
            historyList.innerHTML = '';
            
            if (orders.length === 0) {
                historyEmpty.style.display = 'block';
                return;
            }
            
            historyEmpty.style.display = 'none';
            
            orders.forEach(order => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                const statusClass = `status-${order.status}`;
                const statusText = order.status === 'pending' ? 'Chờ duyệt' : 
                                 order.status === 'completed' ? 'Thành công' : 'Thất bại';
                
                historyItem.innerHTML = `
                    <div class="history-info">
                        <div class="history-order-code">${order.code}</div>
                        <div class="history-details">${order.coins} • ${order.price}</div>
                        <div class="history-date">${formatDate(order.date)}</div>
                    </div>
                    <div class="history-status ${statusClass}">
                        ${statusText}
                    </div>
                `;
                
                // Click to view order details
                historyItem.addEventListener('click', () => {
                    showOrderDetailInUser(order);
                });
                
                historyList.appendChild(historyItem);
            });
        };

        // Show order detail in user view
        const showOrderDetailInUser = (order) => {
            searchResults.innerHTML = '';
            searchResults.style.display = 'block';
            searchNotFound.style.display = 'none';
            
            const statusText = order.status === 'pending' ? 'Chờ duyệt' : 
                             order.status === 'completed' ? 'Thành công' : 'Thất bại';
            
            const statusClass = `status-${order.status}`;
            
            const orderDetail = document.createElement('div');
            orderDetail.className = 'order-detail';
            orderDetail.innerHTML = `
                <h3 class="order-detail-title">Chi Tiết Đơn Hàng</h3>
                <div class="order-detail-item">
                    <span class="order-detail-label">Mã đơn hàng:</span>
                    <span class="order-detail-value" style="color: #ff0050; font-family: monospace;">${order.code}</span>
                </div>
                <div class="order-detail-item">
                    <span class="order-detail-label">Gói xu:</span>
                    <span class="order-detail-value">${order.coins}</span>
                </div>
                <div class="order-detail-item">
                    <span class="order-detail-label">Giá:</span>
                    <span class="order-detail-value">${order.price}</span>
                </div>
                <div class="order-detail-item">
                    <span class="order-detail-label">Phương thức thanh toán:</span>
                    <span class="order-detail-value">${getPaymentMethodName(order.method)}</span>
                </div>
                <div class="order-detail-item">
                    <span class="order-detail-label">Trạng thái:</span>
                    <span class="order-detail-value"><span class="history-status ${statusClass}">${statusText}</span></span>
                </div>
                <div class="order-detail-item">
                    <span class="order-detail-label">Thời gian:</span>
                    <span class="order-detail-value">${formatDate(order.date)}</span>
                </div>
            `;
            
            searchResults.appendChild(orderDetail);
            
            // Switch to search tab
            navTabs.forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="search"]').classList.add('active');
            rechargeTab.style.display = 'none';
            historyTab.style.display = 'none';
            searchTab.style.display = 'block';
        };

        // Search order in user view
        const searchOrderInUser = () => {
            const searchCode = searchOrderInput.value.trim().toUpperCase();
            
            if (!searchCode) {
                alert('Vui lòng nhập mã đơn hàng');
                return;
            }
            
            const foundOrder = findOrderByCode(searchCode);
            
            if (foundOrder) {
                showOrderDetailInUser(foundOrder);
            } else {
                searchResults.style.display = 'none';
                searchNotFound.style.display = 'block';
            }
        };

        // ==================== TRANG QUẢN TRỊ - CHỨC NĂNG ====================

        // Update statistics
        const updateAdminStats = () => {
            const orders = getOrders();
            const pending = orders.filter(order => order.status === 'pending').length;
            const completed = orders.filter(order => order.status === 'completed').length;
            const failed = orders.filter(order => order.status === 'failed').length;
            const total = orders.length;

            pendingCount.textContent = pending;
            completedCount.textContent = completed;
            failedCount.textContent = failed;
            totalCount.textContent = total;
        };

        // Render orders table in admin
        const renderAdminOrders = () => {
            const orders = getOrders();
            ordersTableBody.innerHTML = '';
            
            if (orders.length === 0) {
                ordersTableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-search" style="font-size: 40px; margin-bottom: 15px; display: block;"></i>
                            <p>Không tìm thấy đơn hàng nào</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                const statusClass = `status-${order.status}`;
                const statusText = order.status === 'pending' ? 'Chờ duyệt' : 
                                 order.status === 'completed' ? 'Thành công' : 'Thất bại';
                
                row.innerHTML = `
                    <td>
                        <span class="order-code">${order.code}</span>
                    </td>
                    <td>
                        <div><strong>${order.coins}</strong></div>
                        <div style="font-size: 12px; color: #aaa;">${order.bonus}</div>
                        <div style="font-size: 12px; color: #00ff7f;">${order.price}</div>
                    </td>
                    <td>${getPaymentMethodName(order.method)}</td>
                    <td>${formatDate(order.date)}</td>
                    <td>
                        <span class="order-status ${statusClass}">${statusText}</span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn btn-detail" data-id="${order.id}">
                                <i class="fas fa-eye"></i> Chi tiết
                            </button>
                            ${order.status === 'pending' ? `
                                <button class="action-btn btn-approve" data-id="${order.id}">
                                    <i class="fas fa-check"></i> Duyệt
                                </button>
                                <button class="action-btn btn-reject" data-id="${order.id}">
                                    <i class="fas fa-times"></i> Từ chối
                                </button>
                            ` : ''}
                        </div>
                    </td>
                `;
                
                ordersTableBody.appendChild(row);
            });
            
            // Add event listeners to action buttons
            document.querySelectorAll('.btn-detail').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const orderId = parseInt(e.target.closest('button').getAttribute('data-id'));
                    showOrderDetailInAdmin(orderId);
                });
            });
            
            document.querySelectorAll('.btn-approve').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const orderId = parseInt(e.target.closest('button').getAttribute('data-id'));
                    approveOrderAction(orderId);
                });
            });
            
            document.querySelectorAll('.btn-reject').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const orderId = parseInt(e.target.closest('button').getAttribute('data-id'));
                    rejectOrderAction(orderId);
                });
            });
        };

        // Show order detail in admin modal
        const showOrderDetailInAdmin = (orderId) => {
            const orders = getOrders();
            selectedOrder = orders.find(order => order.id === orderId);
            
            if (selectedOrder) {
                modalOrderCode.textContent = selectedOrder.code;
                modalCoins.textContent = selectedOrder.coins;
                modalPrice.textContent = selectedOrder.price;
                modalMethod.textContent = getPaymentMethodName(selectedOrder.method);
                modalDate.textContent = formatDate(selectedOrder.date);
                modalUser.textContent = selectedOrder.user;
                modalPhone.textContent = selectedOrder.phone;
                
                // Update status
                modalStatus.textContent = selectedOrder.status === 'pending' ? 'Chờ duyệt' : 
                                        selectedOrder.status === 'completed' ? 'Thành công' : 'Thất bại';
                modalStatus.className = `order-status status-${selectedOrder.status}`;
                
                // Show/hide action buttons based on status
                if (selectedOrder.status === 'pending') {
                    approveOrderBtn.style.display = 'flex';
                    rejectOrderBtn.style.display = 'flex';
                } else {
                    approveOrderBtn.style.display = 'none';
                    rejectOrderBtn.style.display = 'none';
                }
                
                orderModal.style.display = 'flex';
            }
        };

        // Approve order in admin
        const approveOrderAction = async (orderId) => {
            const updatedOrder = updateOrder(orderId, { status: 'completed' });
            if (updatedOrder) {
                updateAdminStats();
                renderAdminOrders();
                if (selectedOrder && selectedOrder.id === orderId) {
                    orderModal.style.display = 'none';
                }
                
                // Send Telegram notification
                await sendTelegramNotification(updatedOrder, 'approved');
            }
        };

        // Reject order in admin
        const rejectOrderAction = async (orderId) => {
            const updatedOrder = updateOrder(orderId, { status: 'failed' });
            if (updatedOrder) {
                updateAdminStats();
                renderAdminOrders();
                if (selectedOrder && selectedOrder.id === orderId) {
                    orderModal.style.display = 'none';
                }
                
                // Send Telegram notification
                await sendTelegramNotification(updatedOrder, 'rejected');
            }
        };

        // Filter orders in admin
        const filterAdminOrders = () => {
            // Implementation for admin filtering
            updateAdminStats();
            renderAdminOrders();
        };

        // ==================== THÔNG BÁO TELEGRAM ====================

        // Send Telegram notification
        const sendTelegramNotification = async (order, action) => {
            let message = '';
            
            switch (action) {
                case 'created':
                    message = `🆕 ĐƠN HÀNG MỚI

📦 Mã đơn hàng: ${order.code}
💰 Gói xu: ${order.coins}
💵 Số tiền: ${order.price}
👤 Người dùng: ${order.user}
⏰ Thời gian: ${formatDate(order.date)}

⚠️ Vui lòng kiểm tra và xử lý đơn hàng!`;
                    break;
                    
                case 'approved':
                    message = `✅ ĐƠN HÀNG ĐÃ ĐƯỢC DUYỆT

📦 Mã đơn hàng: ${order.code}
💰 Gói xu: ${order.coins}
💵 Số tiền: ${order.price}
👤 Người dùng: ${order.user}
⏰ Thời gian duyệt: ${formatDate(new Date())}

🎉 Đơn hàng đã được xử lý thành công!`;
                    break;
                    
                case 'rejected':
                    message = `❌ ĐƠN HÀNG BỊ TỪ CHỐI

📦 Mã đơn hàng: ${order.code}
💰 Gói xu: ${order.coins}
💵 Số tiền: ${order.price}
👤 Người dùng: ${order.user}
⏰ Thời gian từ chối: ${formatDate(new Date())}

🔍 Lý do: Không hợp lệ hoặc thiếu thông tin`;
                    break;
            }

            const result = await sendTelegramMessage(message, order);
            
            if (result.success) {
                console.log(`✅ Đã gửi thông báo Telegram: ${action}`);
            } else {
                console.error(`❌ Lỗi gửi Telegram: ${result.error}`);
            }
            
            return result;
        };

        // ==================== CẤU HÌNH BOT ====================

        // Load bot configuration
        const loadBotConfig = () => {
            const config = getBotConfig();
            botToken.value = config.botToken;
            chatId.value = config.chatId;
            botName.value = config.botName;
            webhookUrl.value = config.webhookUrl;
        };

        // Save bot configuration
        const saveBotConfiguration = () => {
            const config = {
                botToken: botToken.value.trim(),
                chatId: chatId.value.trim(),
                botName: botName.value.trim() || 'TikTok Coin Bot',
                webhookUrl: webhookUrl.value.trim(),
                enabled: true
            };
            
            saveBotConfig(config);
            showConfigStatus('✅ Cấu hình đã được lưu thành công!', 'success');
        };

        // Test bot configuration
        const testBotConfiguration = async () => {
            const config = getBotConfig();
            
            if (!config.botToken || !config.chatId) {
                showConfigStatus('❌ Vui lòng nhập đầy đủ Bot Token và Chat ID', 'error');
                return;
            }
            
            showConfigStatus('🔄 Đang kiểm tra kết nối...', '');
            
            const result = await testBotConnection();
            
            if (result.success) {
                showConfigStatus(`✅ ${result.message}`, 'success');
            } else {
                showConfigStatus(`❌ ${result.error}`, 'error');
            }
        };

        // Show config status
        const showConfigStatus = (message, type) => {
            configStatus.textContent = message;
            configStatus.className = 'config-status';
            
            if (type === 'success') {
                configStatus.classList.add('status-success');
            } else if (type === 'error') {
                configStatus.classList.add('status-error');
            }
            
            configStatus.style.display = 'block';
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                configStatus.style.display = 'none';
            }, 5000);
        };

        // Toggle bot config section
        const toggleBotConfig = () => {
            const isVisible = botConfigSection.style.display !== 'none';
            botConfigSection.style.display = isVisible ? 'none' : 'block';
            configButton.innerHTML = isVisible ? 
                '<i class="fas fa-robot"></i> Cấu hình Bot' : 
                '<i class="fas fa-times"></i> Đóng Cấu hình';
        };

        // ==================== KHỞI TẠO VÀ SỰ KIỆN ====================

        // Initialize the application
        const init = () => {
            initializeSampleData();
            loadBotConfig();
            
            // User page initialization
            paymentMethods[0].classList.add('selected');
            selectedPayment = paymentMethods[0];
            updateUserHistoryDisplay();
            
            // Admin page initialization
            updateAdminStats();
            renderAdminOrders();
            setupEventListeners();
        };

        // Setup event listeners
        const setupEventListeners = () => {
            // ========== USER PAGE EVENTS ==========
            
            // Tab navigation
            navTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-tab');
                    
                    navTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    rechargeTab.style.display = 'none';
                    historyTab.style.display = 'none';
                    searchTab.style.display = 'none';
                    
                    if (tabName === 'recharge') {
                        rechargeTab.style.display = 'block';
                    } else if (tabName === 'history') {
                        historyTab.style.display = 'block';
                        updateUserHistoryDisplay();
                    } else {
                        searchTab.style.display = 'block';
                        searchResults.style.display = 'none';
                        searchNotFound.style.display = 'none';
                        searchOrderInput.value = '';
                    }
                });
            });
            
            // History button click
            historyButton.addEventListener('click', () => {
                navTabs.forEach(t => t.classList.remove('active'));
                document.querySelector('[data-tab="history"]').classList.add('active');
                rechargeTab.style.display = 'none';
                historyTab.style.display = 'block';
                searchTab.style.display = 'none';
                updateUserHistoryDisplay();
            });
            
            // Search button click
            searchButton.addEventListener('click', () => {
                navTabs.forEach(t => t.classList.remove('active'));
                document.querySelector('[data-tab="search"]').classList.add('active');
                rechargeTab.style.display = 'none';
                historyTab.style.display = 'none';
                searchTab.style.display = 'block';
                searchResults.style.display = 'none';
                searchNotFound.style.display = 'none';
                searchOrderInput.value = '';
            });
            
            // Admin button click
            adminButton.addEventListener('click', () => {
                rechargePage.style.display = 'none';
                adminPage.style.display = 'block';
                updateAdminStats();
                renderAdminOrders();
            });
            
            adminButtonPayment.addEventListener('click', () => {
                paymentPage.style.display = 'none';
                adminPage.style.display = 'block';
                updateAdminStats();
                renderAdminOrders();
            });
            
            // Search order event
            searchOrderButton.addEventListener('click', searchOrderInUser);
            searchOrderInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchOrderInUser();
                }
            });
            
            // Package selection
            coinPackages.forEach(pkg => {
                pkg.addEventListener('click', () => {
                    coinPackages.forEach(p => p.classList.remove('selected'));
                    pkg.classList.add('selected');
                    selectedPackage = pkg;
                    updateRechargeButton();
                });
            });
            
            // Payment method selection
            paymentMethods.forEach(method => {
                method.addEventListener('click', () => {
                    paymentMethods.forEach(m => m.classList.remove('selected'));
                    method.classList.add('selected');
                    selectedPayment = method;
                    updateRechargeButton();
                });
            });
            
            // Navigate to payment page
            rechargeBtn.addEventListener('click', () => {
                if (selectedPackage && selectedPayment) {
                    // Generate new order code
                    currentOrderCode = generateOrderCode();
                    
                    // Update order details
                    const coins = selectedPackage.getAttribute('data-coins');
                    const price = selectedPackage.getAttribute('data-price');
                    const bonus = selectedPackage.querySelector('.coin-bonus').textContent;
                    const paymentName = selectedPayment.querySelector('.payment-name').textContent;
                    
                    orderCoins.textContent = coins + ' Xu';
                    orderBonus.textContent = bonus;
                    orderMethod.textContent = paymentName;
                    orderTotal.textContent = formatPrice(price) + 'đ';
                    orderCode.textContent = currentOrderCode;
                    bankAmount.textContent = formatPrice(price) + 'đ';
                    bankContent.textContent = `NAPXU TIKTOK ${currentOrderCode}`;
                    
                    // Show appropriate payment form
                    const paymentType = selectedPayment.getAttribute('data-method');
                    creditCardForm.style.display = paymentType === 'credit' ? 'block' : 'none';
                    momoForm.style.display = paymentType === 'momo' ? 'block' : 'none';
                    zalopayForm.style.display = paymentType === 'zalopay' ? 'block' : 'none';
                    bankingForm.style.display = paymentType === 'banking' ? 'block' : 'none';
                    
                    // Hiển thị thông báo Telegram
                    telegramNotification.style.display = 'block';
                    
                    // Switch to payment page
                    rechargePage.style.display = 'none';
                    paymentPage.style.display = 'block';
                }
            });
            
            // Back to recharge page
            backButton.addEventListener('click', () => {
                paymentPage.style.display = 'none';
                rechargePage.style.display = 'block';
                successMessage.style.display = 'none';
                telegramNotification.style.display = 'none';
            });
            
            // Process payment
            payButton.addEventListener('click', () => {
                // Hiển thị loading
                loading.style.display = 'block';
                payButton.style.display = 'none';
                
                // Giả lập gửi thông báo đến Telegram
                setTimeout(() => {
                    // Ẩn loading
                    loading.style.display = 'none';
                    
                    // Hiển thị thông báo thành công
                    const coins = selectedPackage.getAttribute('data-coins');
                    const price = selectedPackage.getAttribute('data-price');
                    const paymentName = selectedPayment.querySelector('.payment-name').textContent;
                    const bonus = selectedPackage.querySelector('.coin-bonus').textContent;
                    
                    successCoins.textContent = coins;
                    successOrderCode.textContent = currentOrderCode;
                    
                    // Ẩn form thanh toán và hiển thị thông báo thành công
                    document.querySelector('.payment-form').style.display = 'none';
                    telegramNotification.style.display = 'none';
                    successMessage.style.display = 'block';
                    
                    // Save order to history
                    const order = {
                        code: currentOrderCode,
                        coins: coins + ' Xu',
                        price: formatPrice(price) + 'đ',
                        method: paymentName,
                        bonus: bonus
                    };
                    
                    saveOrderToHistory(order);
                }, 2000);
            });
            
            // Continue after successful payment
            continueButton.addEventListener('click', () => {
                paymentPage.style.display = 'none';
                rechargePage.style.display = 'block';
                successMessage.style.display = 'none';
                payButton.style.display = 'block';
                
                // Reset selections
                coinPackages.forEach(p => p.classList.remove('selected'));
                paymentMethods.forEach(m => m.classList.remove('selected'));
                selectedPackage = null;
                selectedPayment = null;
                updateRechargeButton();
                
                // Show forms again
                creditCardForm.style.display = 'block';
                momoForm.style.display = 'none';
                zalopayForm.style.display = 'none';
                bankingForm.style.display = 'none';
                telegramNotification.style.display = 'none';
            });
            
            // ========== ADMIN PAGE EVENTS ==========
            
            // Refresh admin
            refreshAdmin.addEventListener('click', () => {
                updateAdminStats();
                renderAdminOrders();
            });
            
            // Back to user page
            backToUser.addEventListener('click', () => {
                adminPage.style.display = 'none';
                rechargePage.style.display = 'block';
            });
            
            // Bot config button
            configButton.addEventListener('click', toggleBotConfig);
            
            // Save bot config
            saveBotConfigBtn.addEventListener('click', saveBotConfiguration);
            
            // Test bot config
            testBotConfigBtn.addEventListener('click', testBotConfiguration);
            
            // Modal events
            closeModal.addEventListener('click', () => {
                orderModal.style.display = 'none';
            });
            
            approveOrderBtn.addEventListener('click', () => {
                if (selectedOrder) {
                    approveOrderAction(selectedOrder.id);
                }
            });
            
            rejectOrderBtn.addEventListener('click', () => {
                if (selectedOrder) {
                    rejectOrderAction(selectedOrder.id);
                }
            });
            
            // Filter events
            statusFilter.addEventListener('change', filterAdminOrders);
            paymentFilter.addEventListener('change', filterAdminOrders);
            searchOrderAdmin.addEventListener('input', filterAdminOrders);
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === orderModal) {
                    orderModal.style.display = 'none';
                }
            });
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
